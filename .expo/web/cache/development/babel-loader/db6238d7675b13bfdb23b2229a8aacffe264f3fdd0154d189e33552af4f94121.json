{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/sammerinio/Documents/flight-tracking-app/context/ApplicationContext.js\";\nimport React, { useState } from \"react\";\nimport Context from \"./context\";\nimport { ably } from \"../env\";\nvar HUB_STREAM = \"[product:ably-flightradar24/heathrow-flights]flights:plane\";\nexport default ApplicationContext = function ApplicationContext(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    arrivals = _useState2[0],\n    setArrivalsData = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isLoading = _useState4[0],\n    setIsLoading = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    departures = _useState6[0],\n    setDeparturesData = _useState6[1];\n  var setChannel = function setChannel(iATA) {\n    console.log(\"This \" + iATA + \" was clicked\");\n    return ably.channels.get(HUB_STREAM + \":\" + iATA);\n  };\n  var departureListener = function departureListener(message) {\n    console.log(\"Still Listening Departure\", message.data);\n    message.data && subscribe(message.data);\n  };\n  var arrivalListener = function arrivalListener(message) {\n    console.log(\"Still Listening\", message.data);\n    message.data && subscribe(message.data);\n  };\n  var subscribe = function subscribe(data) {\n    setIsLoading(false);\n    setArrivalsData(data);\n  };\n  var unsubscribe = function unsubscribe(useChannel, type) {\n    console.log(\"unmounting sub \" + type);\n    useChannel.off();\n    useChannel.unsubscribe();\n    type === \"arrival\" ? setArrivalsData(null) : setDeparturesData(null);\n    setIsLoading(true);\n  };\n  var setArrivals = function setArrivals(iATA, action) {\n    action === \"reset\" ? unsubscribe(setChannel(iATA), \"arrival\") : setChannel(iATA).subscribe(arrivalListener);\n  };\n  var setDepartures = function setDepartures(iATA, action) {\n    action === \"reset\" ? unsubscribe(setChannel(iATA), \"departure\") : setChannel(iATA).subscribe(departureListener);\n  };\n  return React.createElement(Context.Provider, {\n    value: {\n      arrivals: arrivals,\n      departures: departures,\n      isLoading: isLoading,\n      setIsLoading: setIsLoading,\n      setArrivals: setArrivals,\n      setDepartures: setDepartures\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    }\n  }, children);\n};","map":{"version":3,"names":["React","useState","Context","ably","HUB_STREAM","ApplicationContext","_ref","children","_useState","_useState2","_slicedToArray","arrivals","setArrivalsData","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","departures","setDeparturesData","setChannel","iATA","console","log","channels","get","departureListener","message","data","subscribe","arrivalListener","unsubscribe","useChannel","type","off","setArrivals","action","setDepartures","createElement","Provider","value","__source","fileName","_jsxFileName","lineNumber"],"sources":["/Users/sammerinio/Documents/flight-tracking-app/context/ApplicationContext.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport Context from \"./context\";\nimport { ably } from \"../env\";\n\nconst HUB_STREAM = \"[product:ably-flightradar24/heathrow-flights]flights:plane\";\n\nexport default ApplicationContext = ({ children }) => {\n  const [arrivals, setArrivalsData] = useState(null);\n\n  const [isLoading, setIsLoading] = useState(true);\n\n  const [departures, setDeparturesData] = useState(null);\n\n  //add subscrpition listeners here\n  const setChannel = (iATA) => {\n    console.log(`This ${iATA} was clicked`);\n    return ably.channels.get(`${HUB_STREAM}:${iATA}`);\n  };\n\n  const departureListener = (message) => {\n    console.log(\"Still Listening Departure\", message.data);\n    message.data && subscribe(message.data);\n  };\n\n  const arrivalListener = (message) => {\n    console.log(\"Still Listening\", message.data);\n    message.data && subscribe(message.data);\n  };\n\n  const subscribe = (data) => {\n    setIsLoading(false);\n    setArrivalsData(data);\n  };\n\n  // add unsubscribe listeners here\n  const unsubscribe = (useChannel, type) => {\n    console.log(`unmounting sub ${type}`);\n    useChannel.off();\n    useChannel.unsubscribe();\n    type === \"arrival\" ? setArrivalsData(null) : setDeparturesData(null);\n    setIsLoading(true);\n  };\n\n  const setArrivals = (iATA, action) => {\n    action === \"reset\"\n      ? unsubscribe(setChannel(iATA), \"arrival\")\n      : setChannel(iATA).subscribe(arrivalListener);\n  };\n\n  const setDepartures = (iATA, action) => {\n    action === \"reset\"\n      ? unsubscribe(setChannel(iATA), \"departure\")\n      : setChannel(iATA).subscribe(departureListener);\n  };\n\n  return (\n    <Context.Provider\n      value={{\n        arrivals,\n        departures,\n        isLoading,\n        setIsLoading,\n        setArrivals,\n        setDepartures,\n      }}\n    >\n      {children}\n    </Context.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}